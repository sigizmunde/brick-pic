parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"zemw":[function(require,module,exports) {
"use strict";function t(t,e){console.log("imageData = ",t);const n=t.width,r=t.height,a=Math.floor(n/e)||1,l=Math.floor(r/a);console.log("block width = ",a),console.log("new dimensions = ",e,"x",l);const c=new ImageData(e,l),{data:i}=c;for(let f=0;f<e;f+=1)for(let n=0;n<l;n+=1){const r=[0,0,0,0];for(let e=f*a;e<(f+1)*a;e+=1)for(let l=n*a;l<(n+1)*a;l+=1){const n=o(e,l,t);let c=0;for(;c<4;)r[c]+=n[c]/a**2,c+=1}let l=0;for(;l<4;)i[4*f+n*e*4+l]=Math.round(r[l]),l+=1}return console.log(c),c}function o(t,o,e){const n=o*(4*e.width)+4*t;return[e.data[n],e.data[n+1],e.data[n+2],e.data[n+3]]}function e({data:t}){for(let o=0;o<t.length;o+=4){const e=Math.round((t[o]+t[o+1]+t[o+2])/3),n=t[o+3],r=e*n/255+255-n;t[o]=r,t[o+1]=r,t[o+2]=r,t[o+3]=255}}function n({data:t},o=0){console.log("brightness = ",o);for(let e=0;e<t.length;e+=4){const n=(t[e]+t[e+1]+t[e+2])/3;let r=Math.round(n+n*o/10);r=r>255?255:r,t[e]=r,t[e+1]=r,t[e+2]=r}}function r({data:t},o=1){const e=t.reduce((t,o,e)=>(e+1)%4&&o>t?o:t,0),n=t.reduce((t,o,e)=>(e+1)%4&&o<t?o:t,255),r=(e-n)/2+n;if(console.log("min = ",n,", max = ",e,", middle = ",r,", coef = ",o),n!==e)for(let a=0;a<t.length;a+=4){const e=(t[a]+t[a+1]+t[a+2])/3;let n=Math.round(e+(e-r)*o);n=n>255?255:n<0?0:n,t[a]=n,t[a+1]=n,t[a+2]=n}}function a({data:t},o=1){let e=t.reduce((t,o,e)=>(e+1)%4&&o>t?o:t,0),n=t.reduce((t,o,e)=>(e+1)%4&&o<t?o:t,255);if(console.log("min = ",n,", max = ",e,", coef = ",o),n=(n=Math.round(n*o))>47?47:n,e=(e=Math.round(255-(255-e)*o))<160?160:e,console.log("min = ",n,", max = ",e),n!==e&&(0!==n||255!==e))for(let r=0;r<t.length;r+=4){const o=(t[r]+t[r+1]+t[r+2])/3;let a=Math.round(255/(e-n)*(o-n));a=a>255?255:a,t[r]=a,t[r+1]=a,t[r+2]=a}}function l({data:t},o=[63,127,191,255]){for(let e=0;e<t.length;e+=4){const n=Math.round((t[e]+t[e+1]+t[e+2])/3);let r=0;o.forEach(t=>{n>=t-16&&t>r&&(r=t)}),t[e]=r,t[e+1]=r,t[e+2]=r}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.resizeImage=t,exports.grayscale=e,exports.brightness=n,exports.contrast=r,exports.autoContrast=a,exports.levels=l,exports.mapDataToBricks=i,exports.showBricks=f;const c=[{id:0,border:0,color:"#000000"},{id:1,border:47,color:"#2f2f2f"},{id:2,border:111,color:"#6f6f6f"},{id:3,border:175,color:"#afafaf"},{id:4,border:239,color:"#efefef"}];function i({data:t,width:o},e=c){const n={data:[],width:o,mapping:e};for(let r=0;4*r<t.length;r+=1){const o=Math.round((t[4*r]+t[4*r+1]+t[4*r+2])/3);let a=0;e.forEach(t=>{o>=t.border&&t.id>a&&(a=t.id)}),n.data[r]=a}return n}function f({data:t,width:o,mapping:e},n,r=16){const a=n.getContext("2d");a.clearRect(0,0,n.width,n.height),n.width=o*r,n.height=t.length/o*r,t.map((t,n)=>{var l;const c=(null===(l=e.find(o=>o.id===t))||void 0===l?void 0:l.color)||0;d(n%o,Math.floor(n/o),r,c,a)})}function d(t,o,e,n,r){r.fillStyle=n,r.fillRect(t*e,o*e,e,e),r.strokeStyle="#00000022",r.beginPath(),r.arc((t+.5)*e,(o+.5)*e,.32*e,-.25*Math.PI,.75*Math.PI),r.stroke(),r.strokeStyle="#ffffff44",r.beginPath(),r.arc((t+.5)*e,(o+.5)*e,.32*e,.75*Math.PI,1.75*Math.PI),r.stroke(),r.strokeStyle="#00000018",r.beginPath(),r.moveTo((t+1)*e,o*e),r.lineTo((t+1)*e,(o+1)*e),r.lineTo(t*e,(o+1)*e),r.stroke(),r.strokeStyle="#ffffff18",r.beginPath(),r.moveTo(t*e,(o+1)*e),r.lineTo(t*e,o*e),r.lineTo((t+1)*e,o*e),r.stroke()}
},{}],"DFWH":[function(require,module,exports) {
"use strict";function s(s,t){const{data:e,mapping:i}=s,l=i.map(s=>{const t=e.filter(t=>t===s.id).length;return`<li class="stats_item"><div class="stats_sample" id="${s.id}" style="--color-sample:${s.color}"></div><span>${t} pieces</span></li>`}).join("");t.innerHTML='<ul class="stats_list">'+l+"</ul>"}Object.defineProperty(exports,"__esModule",{value:!0}),exports.showBrickStats=s;
},{}],"d6sW":[function(require,module,exports) {
"use strict";var e=require("./imageprocessor"),t=require("./markupgenerator");const a={size:25,brightness:0,contrast:0},i={};function r(t){a[t.target.name]=parseInt(t.target.value),console.log(a),i.imageData&&(i.resizedImageData=(0,e.resizeImage)(i.imageData,a.size),g(i.resizedImageData))}function n(t){if(t.target.files){const r=t.target.files[0];i.reader.readAsDataURL(r),i.reader.onloadend=function(t){i.image.src=t.target.result,i.image.onload=function(t){const r=document.createElement("canvas"),n=r.getContext("2d");r.width=i.image.width,r.height=i.image.height,n.drawImage(i.image,0,0),i.imageData=n.getImageData(0,0,r.width,r.height),i.resizedImageData=(0,e.resizeImage)(i.imageData,a.size),g(i.resizedImageData)}}}}function g(i){const r=document.getElementById("myCanvas"),n=r.getContext("2d"),{width:g,height:s}=i;r.width=2*i.width,r.height=2*i.height,n.putImageData(i,0,0),(0,e.grayscale)(i),n.putImageData(i,g,0),(0,e.brightness)(i,a.brightness),(0,e.contrast)(i,a.contrast/2),n.putImageData(i,0,s),(0,e.levels)(i),n.putImageData(i,g,s);const o=document.querySelector("#brickCanvas"),m=(0,e.mapDataToBricks)(i);(0,e.showBricks)(m,o),(0,t.showBrickStats)(m,document.querySelector("#brickStats"))}i.reader=new FileReader,i.image=new Image,i.imgInput=document.getElementById("imageInput"),i.imgInput.addEventListener("change",n),i.optionsForm=document.querySelector("#options"),i.optionsForm.querySelectorAll("input").forEach(e=>e.addEventListener("change",r));
},{"./imageprocessor":"zemw","./markupgenerator":"DFWH"}]},{},["d6sW"], null)
//# sourceMappingURL=/brick-pic/main.9bc474db.js.map